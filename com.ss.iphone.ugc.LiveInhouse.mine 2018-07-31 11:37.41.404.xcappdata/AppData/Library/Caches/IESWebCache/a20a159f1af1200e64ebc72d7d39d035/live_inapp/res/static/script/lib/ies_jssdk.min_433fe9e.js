!function(){function e(e){if(void 0===e)return e;var r,t,n,o,c,a;for(n=e.length,t=0,r="";n>t;){if(o=255&e.charCodeAt(t++),t==n){r+=m.charAt(o>>2),r+=m.charAt((3&o)<<4),r+="==";break}if(c=e.charCodeAt(t++),t==n){r+=m.charAt(o>>2),r+=m.charAt((3&o)<<4|(240&c)>>4),r+=m.charAt((15&c)<<2),r+="=";break}a=e.charCodeAt(t++),r+=m.charAt(o>>2),r+=m.charAt((3&o)<<4|(240&c)>>4),r+=m.charAt((15&c)<<2|(192&a)>>6),r+=m.charAt(63&a)}return r}function r(e){for(var r in e)return!1;return!0}function t(e,t){var n=100;if("share"==e){if(t&&!r(t))return t;var o="",c="",a="",i=document.querySelector("title"),f=document.querySelector("meta[name=description]"),u=document.querySelector("link[rel*=apple-touch-icon]"),d=document.querySelector("link[rel*=shortcut]");if(i&&(o=i.innerText),f&&(c=f.content),d&&(a=d.href),u&&(a=u.href),!a)for(var l=document.querySelectorAll("body img"),h=0;h<l.length;h++){var m=l[h];if(m.naturalWidth>n&&m.naturalHeight>n){a=m.src;break}}return{platform:"weixin_moments",url:location.href,title:o,desc:c,image:a}}return t}function n(){l=document.createElement("iframe"),l.id="__ToutiaoJSBridgeIframe_SetResult",l.style.display="none",document.documentElement.appendChild(l),d=document.createElement("iframe"),d.id="__ToutiaoJSBridgeIframe",d.style.display="none",document.documentElement.appendChild(d)}function o(){var e=JSON.stringify(g);return g=[],a("SCENE_FETCHQUEUE",e),e}function c(e){var r,t=e.__msg_type,n=e.__params,o=e.__event_id,c=e.__callback_id;return"callback"==t?(r={__err_code:"cb404"},"string"==typeof c&&"function"==typeof _[c]&&(r=_[c](n),delete _[c])):"event"==t&&(r={__err_code:"ev404"},"string"==typeof o&&"function"==typeof C[o]&&(r=C[o](n))),a("SCENE_HANDLEMSGFROMTT",JSON.stringify(r)),JSON.stringify(r)}function a(r,t){l.src=p+"private/setresult/"+r+"&"+e(h.encode(t))}function i(e,r,n,o){if(o=o||1,e&&"string"==typeof e){"object"!=typeof r&&(r={}),r=t(e,r);var c=(s++).toString();"function"==typeof n&&(_[c]=n);var a={JSSDK:o,func:e,params:r,__msg_type:"call",__callback_id:c};g.push(a),d.src=p+"dispatch_message/"}}function f(e,r){e&&"string"==typeof e&&"function"==typeof r&&(C[e]=r,i("addEventListener",{name:e},null))}function u(e,r){"function"==typeof C[e]&&C[e](r)}var d,l,h={encode:function(e){e=e||"",e=e.replace(/\r\n/g,"\n");for(var r="",t=0;t<e.length;t++){var n=e.charCodeAt(t);128>n?r+=String.fromCharCode(n):n>127&&2048>n?(r+=String.fromCharCode(n>>6|192),r+=String.fromCharCode(63&n|128)):(r+=String.fromCharCode(n>>12|224),r+=String.fromCharCode(n>>6&63|128),r+=String.fromCharCode(63&n|128))}return r},decode:function(e){for(var r="",t=0,n=c1=c2=0;t<e.length;)n=e.charCodeAt(t),128>n?(r+=String.fromCharCode(n),t++):n>191&&224>n?(c2=e.charCodeAt(t+1),r+=String.fromCharCode((31&n)<<6|63&c2),t+=2):(c2=e.charCodeAt(t+1),c3=e.charCodeAt(t+2),r+=String.fromCharCode((15&n)<<12|(63&c2)<<6|63&c3),t+=3);return r}},m="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",g=[],s=1e3,_={},C={},p="bytedance://";window.ToutiaoJSBridge={call:i,on:f,trigger:u,_fetchQueue:o,_handleMessageFromToutiao:c},n()}();