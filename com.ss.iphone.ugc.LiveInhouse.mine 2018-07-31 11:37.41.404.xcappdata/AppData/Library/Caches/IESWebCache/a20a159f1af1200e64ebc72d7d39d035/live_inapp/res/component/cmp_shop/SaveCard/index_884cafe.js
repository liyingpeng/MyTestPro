define("component/cmp_shop/SaveCard/index.vue",function(t,e,o){function s(t){return t&&t.__esModule?t:{"default":t}}Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0;var i=s(t("component/Bus/index")),a=s(t("node_modules/axios/index")),n=s(t("node_modules/qs/lib/index")),d=s(t("component/util/common")),c=s(t("node_modules/byted-via-hotsoon/dist/via.hotsoon.min")),l={data:function(){return{ownerGoods:[],showSelectedGoods:!1,selectNum:0,totalNum:1,saveShow:!0,item_id:""}},created:function(){this.item_id=this.$route.query.item_id},mounted:function(){var t=this;i.default.$on("sendSaveGoods",function(e){t.selectNum=e.length,t.selectNum?(t.ownerGoods.splice(0,1,e[0]),t.$route.query.selected=e[0].promotion_id):(t.ownerGoods.splice(0,1),t.$route.query.selected="")}),i.default.$on("ctrSaveCard",function(e){t.saveShow=e})},methods:{onTogglePannel:function(t){t&&"mask"===t?this.showSelectedGoods=!1:this.ownerGoods.length&&(this.showSelectedGoods=!this.showSelectedGoods)},onDeleteSelectedGoods:function(t){this.selectNum=0,this.ownerGoods.splice(0,1),this.showSelectedGoods=!1,i.default.$emit("deleteGoods",t)},bindGoodsForVideo:function(){var t=this,e="/web/api/ecom/video/bind",o={itemId:this.item_id,promotions:{}};this.ownerGoods.forEach(function(t){o.promotions[t.promotion_id]=t.item_type}),a.default.post(e,o,{headers:{"Content-Type":"application/json"}}).then(function(e){0===e.data.status_code?(c.default.app.syncProductStatus({video_id:t.item_id,product_status:Number(!!t.ownerGoods.length)}),c.default.view.popView()):c.default.app.showToast({title:"保存失败，请重新尝试"})}).catch(function(){c.default.app.showToast({title:"保存失败，请重新尝试"})})},onSave:function(){var t=this,e="/hotsoon/commerce/item_goods_bind/",o={goods_ids:this.ownerGoods.length?this.ownerGoods[0].promotion_id:"",item_id:this.item_id,item_types:this.ownerGoods.length?this.ownerGoods[0].item_type:""},s=n.default.stringify(o);a.default.post(e,s).then(function(e){0===e.data.status_code?(c.default.app.syncProductStatus({video_id:t.item_id,product_status:Number(!!t.ownerGoods.length)}),c.default.view.popView()):c.default.app.showToast({title:"保存失败，请重新尝试"})}).catch(function(){c.default.app.showToast({title:"保存失败，请重新尝试"})})},watchScroll:function(t){this.showSelectedGoods&&d.default.stopEvent(t)}}};e.default=l;var r;r=e&&e.__esModule&&e.default?e.default:o.exports,r.render=function(){var t=this,e=t.$createElement,o=t._self._c||e;return o("div",{directives:[{name:"show",rawName:"v-show",value:"guide"!==t.$route.name,expression:"$route.name !== 'guide'"}],staticClass:"save-card",on:{touchmove:function(e){t.watchScroll(e)}}},[o("div",{staticClass:"pannel-footer-toggle",on:{click:function(){t.onTogglePannel()}}},[o("transition",{attrs:{name:"margin"}},[o("a",{directives:[{name:"show",rawName:"v-show",value:t.showSelectedGoods,expression:"showSelectedGoods"}],staticClass:"pannel-footer-wrapper",attrs:{href:"javascript:;"}},[o("div",{staticClass:"goods-info"},[o("div",{staticClass:"title"},[t._v("我添加的商品")]),t._v(" "),o("div",{staticClass:"content"},[o("ul",{staticClass:"items-list"},t._l(t.ownerGoods,function(e,s){return o("li",{key:s,staticClass:"item"},[o("div",{staticClass:"cover"},[o("img",{attrs:{src:e.cover.url_list[0],alt:""}})]),t._v(" "),o("div",{staticClass:"desc"},[o("div",{staticClass:"title"},[t._v(t._s(e.title))]),t._v(" "),o("div",{staticClass:"price"},[t._v("￥"+t._s(t._f("formatMoney")(e.price)))])]),t._v(" "),o("a",{staticClass:"delete-icon",attrs:{href:"javascript:;"},on:{click:function(){t.onDeleteSelectedGoods(e.promotion_id)}}})])}))])])])])],1),t._v(" "),o("div",{staticClass:"pannel-footer",on:{click:function(){t.onTogglePannel()}}},[o("a",{staticClass:"toggle-info",attrs:{href:"javascript:;"}},[o("div",{staticClass:"icon"}),t._v(" "),o("a",{staticClass:"goods-panel",attrs:{href:"javascript:;"}},[o("div",{staticClass:"percent-desc"},[t._v("\n                    ("+t._s(t.selectNum)+"/"+t._s(t.totalNum)+")\n                ")]),t._v(" "),o("div",{staticClass:"save",on:{click:function(e){e.stopPropagation(),t.onSave()}}},[t._v("\n                    保存\n                ")])])])]),t._v(" "),o("transition",{attrs:{name:"fade"}},[o("a",{directives:[{name:"show",rawName:"v-show",value:t.showSelectedGoods,expression:"showSelectedGoods"}],staticClass:"mask",attrs:{href:"javascript:;"},on:{click:function(){t.onTogglePannel("mask")}}})])],1)},r.staticRenderFns=[],r._scopeId="_v-7f16c4b9"});